Trick={};(function(){var trick={version:"0.5.0",versionDetail:{major:0,minor:5,patch:0}};var isOmegaTrick=true;var isSenchaTouch=Ext.TouchEventManager?true:false;var isExtCore=!isSenchaTouch&&!Ext.ComponentMgr?true:false;var isExtJS=!isSenchaTouch&&!isExtCore?true:false;Ext.apply(Ext,{isOmegaTrick:isOmegaTrick,trick:trick});Ext.applyIf(Ext,{isSenchaTouch:isSenchaTouch,isExtCore:isExtCore,isExtJS:isExtJS});Trick=Ext.trick;Ext.applyIf(Trick,{isSenchaTouch:isSenchaTouch,isExtCore:isExtCore,isExtJS:isExtJS})})();
Ext.apply(Trick,{testingFramework:{name:"yui"},removeScriptTags:function(){var me=this;Ext.select("body script").each(function(el){Ext.removeNode(Ext.getDom(el))},me)}});if(Ext.isExtCore&&!Ext.emptyFn)Ext.emptyFn=function(){};
if(!Ext.Loader)Ext.Loader=Ext.apply({},{load:function(fileList,callback,scope,preserveOrder){var scope=scope||this,head=document.getElementsByTagName("head")[0],fragment=document.createDocumentFragment(),numFiles=fileList.length,loadedFiles=0,me=this;var loadFileIndex=function(index){head.appendChild(me.buildScriptTag(fileList[index],onFileLoaded))};var onFileLoaded=function(){loadedFiles++;if(numFiles==loadedFiles&&typeof callback=="function")callback.call(scope);else if(preserveOrder===true)loadFileIndex(loadedFiles)};
if(preserveOrder===true)loadFileIndex.call(this,0);else{Ext.each(fileList,function(file,index){fragment.appendChild(this.buildScriptTag(file,onFileLoaded))},this);head.appendChild(fragment)}},buildScriptTag:function(filename,callback){var script=document.createElement("script");script.type="text/javascript";script.src=filename;if(script.readyState)script.onreadystatechange=function(){if(script.readyState=="loaded"||script.readyState=="complete"){script.onreadystatechange=null;callback()}};else script.onload=
callback;return script}});if(Ext.isSenchaTouch&&!Function.prototype.createCallback)Ext.apply(Function.prototype,{createCallback:function(){var args=arguments,method=this;return function(){return method.apply(window,args)}}});
if((Ext.isExtCore||Ext.isSenchaTouch)&&!Function.prototype.createSequence)Ext.apply(Function.prototype,{createSequence:function(fcn,scope){var method=this;return typeof fcn!="function"?this:function(){var retval=method.apply(this||window,arguments);fcn.apply(scope||this||window,arguments);return retval}}});
Ext.applyIf(Ext,{getMaxZindex:function(){var ret=0;Ext.select("*").each(function(el){var zIndex=el.getStyle("z-index");if(Ext.isNumber(parseInt(zIndex,10))&&ret<zIndex)ret=zIndex},this);return ret},getScrollPos:function(){var y=document.documentElement.scrollTop>0?document.documentElement.scrollTop:document.body.scrollTop;var x=document.documentElement.scrollLeft>0?document.documentElement.scrollLeft:document.body.scrollLeft;return{x:x,y:y}}});if(Ext.isExtCore)Ext.Element.addMethods({getSize:function(contentSize){return{width:this.getWidth(contentSize),height:this.getHeight(contentSize)}}});if(Ext.isExtCore||Ext.isSenchaTouch)Ext.Element.addMethods({setLeftTop:function(left,top){var me=this,style=me.dom.style;style.left=me.addUnits(left);style.top=me.addUnits(top);return me},getStyles:function(){var ret={};Ext.each(arguments,function(v){ret[v]=this.getStyle(v)},this);return ret}});if(Ext.isExtCore||Ext.isSenchaTouch){Ext.util.TextMetrics=function(){var shared;return{measure:function(el,text,fixedWidth){if(!shared)shared=Ext.util.TextMetrics.Instance(el,fixedWidth);shared.bind(el);shared.setFixedWidth(fixedWidth||"auto");return shared.getSize(text)},createInstance:function(el,fixedWidth){return Ext.util.TextMetrics.Instance(el,fixedWidth)}}}();Ext.util.TextMetrics.Instance=function(bindTo,fixedWidth){var ml=new Ext.Element(document.createElement("div"));document.body.appendChild(ml.dom);
ml.position("absolute");ml.setLeftTop(-1E3,-1E3);ml.hide();if(fixedWidth)ml.setWidth(fixedWidth);var instance={getSize:function(text){ml.update(text);var s=ml.getSize();ml.update("");return s},bind:function(el){ml.setStyle(Ext.fly(el).getStyles("font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"))},setFixedWidth:function(width){ml.setWidth(width)},getWidth:function(text){ml.dom.style.width="auto";return this.getSize(text).width},getHeight:function(text){return this.getSize(text).height}};
instance.bind(bindTo);return instance};Ext.Element.addMethods({getTextWidth:function(text,min,max){return Ext.util.TextMetrics.measure(this.dom,Ext.value(text,this.dom.innerHTML,true)).width.constrain(min||0,max||1E6)}})};Ext.ns("Trick.app","Trick.form","Trick.grid","Trick.util","Trick.plugins","Trick.test","Trick.test.unit","Trick.test.case","Trick.test.case.core","Trick.test.case.touch");Trick.util.clone=function(obj){function doClone(o){if(!o||"object"!==typeof o)return o;if("function"===typeof o.clone)return o.clone();if(o.hasOwnProperty("__clonedTo"))return o.__clonedTo;var c="[object Array]"===Object.prototype.toString.call(o)?[]:{};o.__clonedTo=c;var p,v;for(p in o)if(p!=="__clonedTo"&&o.hasOwnProperty(p)){v=o[p];if(v&&"object"===typeof v)c[p]=doClone(v);else c[p]=v}return c}function finalizeClone(o){if(o.hasOwnProperty("__clonedTo")){delete o.__clonedTo;var p,v;for(p in o)if(o.hasOwnProperty(p)){v=
o[p];if(v&&"object"===typeof v)finalizeClone(v)}}}var clone=doClone(obj);finalizeClone(obj);return clone};Trick.clone=Trick.util.clone;Trick.test.unit.TestCase=function(o){var me=this,ret;switch(Trick.testingFramework.name){case "yui":ret=new YAHOO.tool.TestCase(o);ret.assert=YAHOO.util.Assert;break}return ret};Trick.test.unit.TestLogger=function(id){var me=this,ret;switch(Trick.testingFramework.name){case "yui":ret=new YAHOO.tool.TestLogger(id);break}return ret};Trick.test.unit.TestRunner=function(){var me=this,runner;return{_runner:function(){if(!runner)switch(Trick.testingFramework.name){case "yui":runner=YAHOO.tool.TestRunner;break}return runner},add:function(t){var me=this;switch(Trick.testingFramework.name){case "yui":me._runner().add(t);break}},run:function(){var me=this;switch(Trick.testingFramework.name){case "yui":me._runner().run();break}}}}();Trick.test.unit.TestSuite=function(name){var me=this,ret;switch(Trick.testingFramework.name){case "yui":ret=new YAHOO.tool.TestSuite(name);break}return ret};Trick.app.App=function(){var me=this,setupConfig={};return{setup:function(config){setupConfig=Trick.util.clone(config);config.onReady=config.onReady||Ext.emptyFn;if(Ext.isExtJS&&config.directProvider)Ext.Direct.addProvider(config.directProvider);if(Ext.isSenchaTouch)Ext.setup(config);else Ext.onReady(config.onReady,config.scope||window,config.onReadyOption);Trick.app.App.setupConfig=setupConfig}}}();Application=Trick.app.App;Trick.setup=Trick.app.App.setup;
